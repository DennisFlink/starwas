<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="stylesheet" href="/css/general.css" />
    <link rel="stylesheet" href="/css/header.css" />
    <link rel="stylesheet" href="/css/infocontainer.css" />
    <script src="/src/dist/index.js" defer></script>
    <title>Star Wars</title>
  </head>
  <body>
    <header class="nav">
      <img src="/img/header-background.png" alt="Star wars background image" />
      <h1>
        STAR WARS<br />
        CATALOG
      </h1>
    </header>
    <main>
      <section class="info-container">
        <div class="flex-container-details">
          <h1 class="details">Details</h1>
          <article class="person-info">
            <h2 id="personName">Luke Skywalker</h2>
            <p>Height: <span id="personHeight"></span></p>
            <p>Mass: <span id="personMass"></span></p>
            <p>Hair Color: <span id="personHairColor"></span></p>
            <p>Skin Color: <span id="personSkinColor"></span></p>
            <p>Eye Color: <span id="personEyeColor"></span></p>
            <p>Eye Color: <span id="personEyeColor"></span></p>
            <p>Birth year: <span id="personBirthYear"></span></p>
            <p>Gender: <span id="personGender"></span></p>
          </article>
          <article class="planet-info">
            <h2 id="planetName">Tattoiin</h2>
            <p>Rotation: <span id="planetRotation"></span></p>
            <p>Diameter: <span id="planetDiameter"></span></p>
            <p>Climate: <span id="planetCLimate"></span></p>
            <p>Gravity: <span id="planetGravity"></span></p>
            <p>Terrain: <span id="planetTerrain"></span></p>

          </article>
        </div>
        <div class="flex-container-characters">
          <h1 class="characters">Characters</h1>
          <ul id="characters-list" data-current-page="1">
        
          </ul>
          <nav class="pagination-container">
            <button
              class="pagination-button"
              id="prev-button"
              aria-label="Previous page"
              title="Previous page"
            >
              &lt;
            </button>

            <div id="pagination-numbers"></div>

            <button
              class="pagination-button"
              id="next-button"
              aria-label="Next page"
              title="Next page"
            >
              &gt;
            </button>
          </nav>
        </div>
      </section>
      <script>
        const paginationNumbers = document.getElementById("pagination-numbers");
        const paginatedList = document.getElementById("characters-list");
        const listItems = paginatedList.querySelectorAll("li");
        const nextButton = document.getElementById("next-button");
        const prevButton = document.getElementById("prev-button");

        const paginationLimit = 10;
        const pageCount = Math.ceil(listItems.length / paginationLimit);
        let currentPage = 1;

        const disableButton = (button) => {
          button.classList.add("disabled");
          button.setAttribute("disabled", true);
        };

        const enableButton = (button) => {
          button.classList.remove("disabled");
          button.removeAttribute("disabled");
        };

        const handlePageButtonsStatus = () => {
          if (currentPage === 1) {
            disableButton(prevButton);
          } else {
            enableButton(prevButton);
          }

          if (pageCount === currentPage) {
            disableButton(nextButton);
          } else {
            enableButton(nextButton);
          }
        };

        const handleActivePageNumber = () => {
          document.querySelectorAll(".pagination-number").forEach((button) => {
            button.classList.remove("active");
            const pageIndex = Number(button.getAttribute("page-index"));
            if (pageIndex == currentPage) {
              button.classList.add("active");
            }
          });
        };

        const appendPageNumber = (index) => {
          const pageNumber = document.createElement("button");
          pageNumber.className = "pagination-number";
          pageNumber.innerHTML = index;
          pageNumber.setAttribute("page-index", index);
          pageNumber.setAttribute("aria-label", "Page " + index);

          paginationNumbers.appendChild(pageNumber);
        };

        const getPaginationNumbers = () => {
          for (let i = 1; i <= pageCount; i++) {
            appendPageNumber(i);
          }
        };

        const setCurrentPage = (pageNum) => {
          currentPage = pageNum;

          handleActivePageNumber();
          handlePageButtonsStatus();

          const prevRange = (pageNum - 1) * paginationLimit;
          const currRange = pageNum * paginationLimit;

          listItems.forEach((item, index) => {
            item.classList.add("hidden");
            if (index >= prevRange && index < currRange) {
              item.classList.remove("hidden");
            }
          });
        };

        window.addEventListener("load", () => {
          getPaginationNumbers();
          setCurrentPage(1);

          prevButton.addEventListener("click", () => {
            setCurrentPage(currentPage - 1);
          });

          nextButton.addEventListener("click", () => {
            setCurrentPage(currentPage + 1);
          });

          document.querySelectorAll(".pagination-number").forEach((button) => {
            const pageIndex = Number(button.getAttribute("page-index"));

            if (pageIndex) {
              button.addEventListener("click", () => {
                setCurrentPage(pageIndex);
              });
            }
          });
        });
      </script>
    </main>
  </body>
</html>
